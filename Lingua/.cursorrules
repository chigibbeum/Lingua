# Project Guidelines

## § 1.0 Instructions for AI Agent

When carrying out tasks for this project, you MUST:
- Reference relevant sections from these guidelines when making decisions
- Explicitly mention which sections (by number and name) you are following
- Consult the Architecture Documentation (§ 4.4) before making significant changes
- Adhere to the Code Review Standards (§ 4.0) for all code contributions
- Follow the Design System (§ 2.2) for all UI/UX work
- Git: use Conventional Commits with scope and follow `git-workflow.md`

---

## § 2.0 Project Overview

I am a language learner who is trying to practice grammar and vocabualary through sentence parsing and flashcard review. As of now, there is not a parsing or flashcard tool accessible online that meets my needs. Often, language learning apps have too many features or require a membership. I want an app/website that I can use both on my laptop and mobile devices (phone and tablet). Ihe want a simple website that allows the user to type up or paste sentences, parse the sentences, form flashcards. and review using the flashcards. As for an organizational system, I would like the sentences and flashcardsto be organizable such as by topic (color, food, places, etc.) via a tagging system. Also the flashcards should be able to be organized into decks for the user to practice with. The goal is to keep the app/website simple. All coding, when able to, should be done using Svelte.

---

## § 3.0 Design System and Layout


### § 3.1 Color Palette

**Applicable to all pages of the website unless given clear direction to use a different color**

- **Main Background:** `#222831` (dark grey)
- **Section/Div Backgrounds:** `#31363f` (lighter grey blue)
- **Primary Text:** `#76abae` (light blue)
- **Secondary Text/Subheadings:** `#eeeeee` (off white)
- **Button Background:** `#31363f` (lighter grey blue)
- **Button Text:** `#eeeeee` (off white)
- **Button Hover:** `#415780` (darker light blue)

### § 3.3 Styling
- border-radius; .35rem;

### § 3.4 Buttons/Icons

- All buttons should be icons unless text is requested. 
- Use only icons from icon folder.
- Always used the colors as indicated in the color scheme unless a different color is requested.
- All icons that action as buttons must have an aria label as stated in the icon svelte component 
- Follow the color schemes rules based on where the icon is placed (navigation bar, tool bar, modals)

### § 3.3 Navigation Bar

- Horizontal bar that is fixed to the top of the page that covers the width of the screen.
- Default mode is in a collapsed state that only shows the icons. When `Open.svelte` is clicked, then the naviation bar opens revealing the text labeling each icon.
  - All Text appear to the right of the icon
  - Icons should move to adjust to the text 
  - Icons and Text should remain as centered as possible on the navigation bar
  - Text tied to each icon goes as following
    - `Open.svelte/Collapse.svelte` Dashboard
    - `SentenceLibrary.svelte` Sentences
    - `DeckLibrary.Svelte` Decks
    - `Settings.svelte` Settings
    - `HowToUse.svelte` How To Use
    - `Login.svelete` Login
- Background color: `#31363f`
- Icons on the navigation bar-in order: 
  - `Open.svelte/Collapse.svelte`, `SentenceLibrary.svelte` , `DeckLibrary.Svelte` , `Settings.svelte` ,  `HowToUse.svelte` , and `Login.svelete`
- Color of icons: `#76abae`
- Use only icons from the icon folder
- For dividers use the color : `#eeeeee` 
- All icons must be centered on the navigation bar with the exception of 
  - Login (Far right) Use `Login.svelte` as the icon
  - Dashboard view (Far left) 
    - Use `Open.svelte` when the dashboard is closed
    - Use `Collapse.svetle` when the dashboard is open 



### §3.5 Tool Bar 
- Color scheme 
  - Background: `#31363f` 
  - Icons: `#eeeeee` 
- There will be two tools bars 
  - Parsing Mode - When in parsing mode, all icons to the right of the vertical divider should be tied to parsing actions: New Text, Parsing, Editing, Creating Flashcard from sentence, Save, and History
  - Flaschard Mode - When in flashcard mode, all icons to the right of the vertical divider should be tied to flashcard actions: Creating, Filtering, Save, and History 
  - There is to be a center, vertical divider:
    - To the left will be the icons: `Abc.svelte` and `Flaschard.Mode.svelte`
    - To the right will be the icons only needed for the mode the user is in. 
  - Layout Schema:
    - Centering: use flex; justify content; to center all content 
    - Adaptive Background/Padding: To create a "one-icon-width" padding (24px) around the entire group of icons, make sure the inner div uses the background color provided above and px-6
    - Mode Switch Highlight: To highlight the current mode of the fixed icons, use an active background style color `#76abae`
    - Dynamic Right Side: the icon group on the right is to be rendered conditionally using mode ==='parsing' and mode ==='flashcard', ensuring the number of elements and the visual width adapt instantly when the mode button is clicked.



### § 3.6 Modes
- There will be two mode options: 
  - Parsing Mode
  - Flasard mode
- Each will be imported on the `App.svelte`
- The modes will appear based on a toggle action as attached to their respective icons: 
  - Parsing Mode - `Abc.svelte`
  - Flashcard Mode - `FlashcardMode.svelte`
- To toggle between the modes, it must be seamless
  - Use a single state variable (mode) to control which component is displayed (parsing or flashcard)
  - The toolbar remains fixed in position, but adjusts in size based on the number of icons
  - The main and innder wrapping of the modes must have a consistent layout. Even though the content inside the mode changes, the outder boundary must remain stable, preventing page jumps.
  - Use transition-all duration-500 on the inner wrapper to help smooth out any minor difference in rendering between the two modes. 

#### §1.1 Parsing Mode
- In the mode the user must be able to enter, edit, parse, and save text. 
- Main Features: 
  - Entering and submitting text
  - Text color should be `#eeeeee`
  - Inline tokenized text with contextual hightling. Hightlighting should be in `#31363f`
  - Editing already inputed text. 
  - Saving text into its own file which can be organized by date of creation and a tagging system. 
- In the center of the page will be a text box following this design: 
  - No surrounding box or background 
  - Next to the cursor, show the prompt 'insert text' in the secondary text color 
  - The cursor should be clearly visible and ready for typing.
  - Text is submitted via the "enter" button, when the user moves into a different action, or slicking the `CheckSubmit.svlete` icon
  - After submitting the new text, the cursor should disappear. 
  - Use inline tokenized text with contextual highlighting. 

#### §1.1 Parsing Mode Functions
- When switching between the actions, the layout should match the seamless transition that is explained under the §3.5 Tool Bar guidelines
- Within the parsing mode there are 6 actions: 
 - Add New Text
 - Parse Text
 - Edit Text
 - Create Flashcard
 - Save Notes
 - View History 
- When creating the svelte component for these actions name them according to the action plus the word "action' (i.e. AddNewTextFunction.svelte)
 1: Add new text (icon NewText.svelte)
    - upon start up of the app,this is the defualt page
    - when the user is in the middle of or done parsing, clicking this icon will bring back to parsing mode default page 
    - before starting a new text, the user should be prompted to save the text or continue without saving
    - the user can submit text either by pressing enter on the keyboard, of clicking submit 
      - Submit should be a button with no background (not an icon)
      - The text should read submit 
      - The submit button should only appear, after the user starts typing
    - Text is submitted using the inline tokenized text with contextual hightlighting. . 
    - Automatically switch to parsing action 
  2: Parse text (icon ParseText.svelete)
    - This is the bulk of where the action happens. Here the user can break up text nodes, combine text nodes, and take notes for each text node. 
    - when hovering over or single clicking a node, a popover appears above the node giving the user two options: break and add note:
      - Use `Break.svelte` for the break icon
      - Use `AddNote.svelte` for the add note icon 
    - When highlighting two or more nodes, a box should appear above the node giving the user two options: combine and add note: 
      - Use `Combind.svelte` for the combine icon 
      - Use `AddNote.svelte` for the add note icon
    - When a user wants to break a node, a cursor should appeaer in the node and the user can select where they want to break the node. Either they can (1) press space or (2) press enter to break the node. The node will always break where the cursor is at. 
    - When a user wants to combine two or more nodes, they must highlight the nodes they want combined. The text should remain properly spaced between the words, but it should now appear under one node. 
    - When a user wants to add a note, a modal should appear called `AddNoteModal.svelte` that allows the user to add a note. (More direction for this modal is given under the modal section in this file)
    - After adding a note, an "n" should appear in the top right corner of the node to indicate that a note was added. The text color should #76abae
    - Once a note has been added to a word, the background should remain `#31363f`
  3: Edit Text (icon `EditText.svelte`)
    - In this action the user can go back and edit the text they orginally submitted. However rather than going back to a text box, each text node becomes an editable text node. 
    - When the user single clicks a  text node, a pop up shows above the node. In this pop up a text box with three icons appear: 
      - `InsertLeft.svelte` - the user can add a text node to the left of the node they clicked
      - `InsertRight.svelete ` - the user can add a text node to the right of the node they clicked 
      - `EditNode.svelte` - the user can edit the text in the node they clicked 
 4: Create Flashcards (icon `CreateFlashcards.svelete`)
  - Based on the vocabulary notes the user made, create them into flashcards
 4: Save Notes ( icon `SaveNote.svelte`)
  - This action saves the text and notes the user made on the text nodes. 
  - A modal appears where the user can enter a title for the sentence, tag the sentence, and add a created date.
5: View History (icon `HistoryView.svelte)
 - This action allows the user to view all changes and additions made to the sentence.
      
      

#### § 1.2 Flashcard Mode
- Filter action : filter cards being practiced by deck, part of speech, or tag
- Create action: create cards 

### § 3. Modals
 `SentenceLibraryModal.svelete`
 `DeckLibraryModal.svelte`
 `SettingsModal.svelte`
 `LoginModal.svelte`
 `HowToUseModal.svelte`

#### § Sentence Library - `SentenceLibraryModal.svelete`
  - sentences created and saved by the user appear here

  - only the first 7 words of a sentece appear. When hovered over, the whole sentence appears ( as an aria lable?) 
  - clicking the sentence opens a drop down panel that lists out stats on the sentence 
    - target language
    - number of vocabulary notes
    - number of grammar notes 
  - icons on each sentence that appear on the top right corner
    - view
    - edit
    - delete
  - select action 

#### § Deck Libray - `DeckLibraryModal.svelte`
  - flashcards created and saved by the user appear here 
  - three views : all cards, by tag, and by deck


### § Login Page

*(To be defined)*

---

## § 4.0 Code Review Standards

This section defines how we review code for the Lingua project. Use it for PR reviews, self-reviews, and pre-merge checks.

### § 4.1 Core Principles

- **Readability:** Clear, concise code with meaningful names
- **SRP/DRY/Modularity:** Single responsibility, avoid duplication, and maintain clear component boundaries
- **Idiomatic Usage:** Follow official patterns for Svelte 5/SvelteKit
- **Technical Debt:** Remove bloat and redundancies as you touch code
- **Error Handling:** Consistent, actionable errors; no swallowed exceptions
- **Security & Performance:** No new vulnerabilities; no unexpected regressions

### § 4.2 Review Checklist

#### § 4.2.1 Functional Correctness

- No regressions; existing behaviors preserved
- Edge cases identified and handled

#### § 4.2.2 Maintainability and Design

- Code is easy to read and navigate
- Adheres to Single Responsibility Principle (SRP)
- Eliminates duplication (DRY)
- Eliminates any unused variables
- Decoupled, modular components with clear boundaries
- Uses idiomatic project/library patterns
- Removes legacy code and bloat where feasible
- Consistent, appropriate error handling

#### § 4.2.3 Compliance and Security

- No new security flaws; auth and data access patterns respected
- No unexpected performance degradation or resource spikes

#### § 4.2.4 Architecture & Patterns Alignment

- Domain-driven multi-store architecture is respected
- Smart Store pattern is followed for feature-domain stores
- Svelte 5 Runes patterns and accessibility requirements are followed
- Optimistic UI patterns are used for mutations where appropriate

### § 4.3 Review Process

- Verify accessibility and keyboard navigation for interactive UI
- Prefer concrete suggestions and links to guidelines when requesting changes

### § 4.4 Architecture Documentation

The `web/documentation/architecture` folder contains several files that provide detailed information about the system's design. When working on related tasks, please refer to the relevant file as described below:

#### § 4.4.1 System Overview (`00-system-overview.md`)

- **Purpose:** Provides a high-level summary of the FLIP application, its goals, and a diagram of the overall architecture
- **When to reference:** For general understanding of the system, client/server boundaries, and the main technology stack

#### § 4.4.2 Domain-Driven Multi-Store Approach (`01-domain-driven-multistore.md`)

- **Purpose:** Explains the rationale and implementation of the domain-driven multi-store pattern used for state management
- **When to reference:** When designing, updating, or reviewing stores, or when considering how data flows through the application

#### § 4.4.3 Smart Store Pattern (`02-smart-store-pattern.md`)

- **Purpose:** Details the Smart Store pattern, including best practices for encapsulating business logic within stores
- **When to reference:** When implementing or refactoring stores to ensure they follow the Smart Store pattern

#### § 4.4.4 Component and Page Structure (`03-component-page-structure.md`)

- **Purpose:** Outlines the organization of UI components and pages, including naming conventions and recommended boundaries
- **When to reference:** When creating new components/pages or reorganizing existing ones

#### § 4.4.5 Data Flow and Interactions (`04-data-flow-and-interactions.md`)

- **Purpose:** Describes how data moves between stores, components, and external services
- **When to reference:** When troubleshooting data issues, optimizing performance, or integrating new features

**General Guidance:**  
Always consult the relevant architecture file(s) before making significant changes to the codebase. This ensures consistency with project patterns and helps maintain long-term maintainability and clarity.

### § 4.5 Agent Guidelines

The `web/documentation/agent-guidelines` folder contains specific guidelines for common development tasks.

#### § 4.5.1 Icon Usage Guidelines (`icon-usage-guidelines.md`)

- **Purpose:** Defines how to use the Svelte 5 icon components, including prop usage, color palette integration, and import patterns
- **When to reference:** When adding icons to components, creating new icon components, or working with visual elements that need icons